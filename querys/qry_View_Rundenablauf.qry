SELECT Turnier.Turnier_Name, "T" & [Turnier_Nummer] & "_RT" & [rundentab].[rt_id] & ".txt" AS RT_file, Tanz_Runden_fix.RundeArt, Paare_Rundenqualifikation.PR_ID, Paare_Rundenqualifikation.RT_ID, Paare_Rundenqualifikation.Rundennummer, Paare_Rundenqualifikation.nochmal, [Rundentext] & " - " & [Startklasse_text] AS Tanzrunde_Text, (SELECT Max(Rundennummer) AS MRnr FROM Paare_Rundenqualifikation GROUP BY RT_ID HAVING Paare_Rundenqualifikation.RT_ID=Rundentab.rt_id;) AS Tanzrunde_MAX, (SELECT m.WR7_Punkte FROM (Rundentab r INNER JOIN Majoritaet m ON r.RT_ID = m.RT_ID) INNER JOIN Tanz_Runden_fix t ON r.Runde = t.Runde WHERE m.TP_ID=[Paare_Rundenqualifikation].[TP_ID] AND t.zweite_Runde=[Rundentab].[Runde] AND r.Startklasse=[Rundentab].[Startklasse];) AS ersteRunde, (SELECT m.WR7_Punkte
FROM (Rundentab AS r INNER JOIN Majoritaet AS m ON r.RT_ID = m.RT_ID) INNER JOIN Tanz_Runden_fix AS t ON r.Runde = t.Runde
WHERE (((m.TP_ID)=[Paare_Rundenqualifikation].[TP_ID]) AND ((t.Runde)=[Rundentab].[Runde]) AND ((r.Startklasse)=[Rundentab].[Startklasse]));) AS jetztRunde, Rundentab.Startklasse, Startklasse.Land, Rundentab.Runde, Rundentab.Anz_Paare, (SELECT TOP 1 n.Paare FROM Rundentab as n WHERE n.Rundenreihenfolge>Rundentab.Rundenreihenfolge AND n.Startklasse=Rundentab.Startklasse ORDER BY n.Rundenreihenfolge;) AS NextPaare, Rundentab.Rundenreihenfolge, (SELECT Count(*) AS Anz FROM Paare_Rundenqualifikation as r WHERE r.rundennummer=Paare_Rundenqualifikation.rundennummer AND r.RT_ID=rundentab.rt_id;) AS PpR, [Da_Vorname] & " " & [Da_Nachname] AS Dame, [He_Vorname] & " " & [He_Nachname] AS Herr, Paare.*, Rundentab.ranking_anzeige
FROM (Turnier INNER JOIN ((Rundentab INNER JOIN Tanz_Runden_fix ON Rundentab.Runde = Tanz_Runden_fix.Runde) INNER JOIN Startklasse ON Rundentab.Startklasse = Startklasse.Startklasse) ON Turnier.Turniernum = Rundentab.Turniernr) INNER JOIN (Paare INNER JOIN Paare_Rundenqualifikation ON Paare.TP_ID = Paare_Rundenqualifikation.TP_ID) ON Rundentab.RT_ID = Paare_Rundenqualifikation.RT_ID;

